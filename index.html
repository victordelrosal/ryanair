<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ryanair Board BI Dashboard</title>
  <style>
    :root{
      --ryanair-blue:#073590; --ryanair-yellow:#F1C933; --ryanair-light-blue:#1E5AA8; --ryanair-dark-blue:#041F50;
      --bg:#FFFFFF; --panel:#F8F9FA; --muted:#E9ECEF; --ink:#073590; --ink-dim:#5A7BA6; --accent:#F1C933; --good:#28A745; --warn:#FFC107; --bad:#DC3545; --shadow:rgba(7,53,144,.15);
      --card-radius:8px; --pad:18px; --gap:18px; --ring:0 0 0 3px var(--accent) inset;
      --font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; background:#FFFFFF; color:var(--ink); font:15px/1.45 var(--font)}
    header{position:sticky; top:0; z-index:5; display:flex; align-items:center; justify-content:space-between; padding:16px var(--pad); background:var(--ryanair-blue); backdrop-filter: blur(10px); border-bottom:3px solid var(--ryanair-yellow)}
    .brand{display:flex; align-items:center; gap:12px; font-weight:700; letter-spacing:.5px; color:#FFFFFF}
    .logo{width:40px; height:40px; border-radius:4px; background: var(--ryanair-yellow); box-shadow:0 4px 12px rgba(241,201,51,.4); display:flex; align-items:center; justify-content:center; font-weight:900; font-size:20px; color:var(--ryanair-blue)}
    .title{font-size:18px; color:#FFFFFF}
    .controls{display:flex; align-items:center; gap:10px}
    .btn{display:inline-flex; align-items:center; gap:8px; padding:10px 16px; border-radius:4px; background:var(--ryanair-yellow); color:var(--ryanair-blue); border:none; cursor:pointer; transition:.2s all; font-weight:600}
    .btn:hover{transform:translateY(-2px); background:#FFD54F; box-shadow:0 4px 12px rgba(241,201,51,.5)}
    .btn .dot{width:8px; height:8px; border-radius:999px; background:var(--ryanair-blue)}

    main{padding:20px; max-width:1400px; margin:0 auto}
    .grid{display:grid; gap:var(--gap)}
    .kpis{grid-template-columns:repeat(6, minmax(0,1fr))}
    @media (max-width:1200px){ .kpis{grid-template-columns:repeat(3,1fr)} }
    @media (max-width:720px){ .kpis{grid-template-columns:repeat(2,1fr)} }

    .card{background:#FFFFFF; border:2px solid #E9ECEF; border-radius:var(--card-radius); padding:var(--pad); box-shadow:0 2px 8px var(--shadow)}
    .card h3{margin:0 0 10px 0; font-size:14px; font-weight:700; color:var(--ryanair-blue); text-transform:uppercase; letter-spacing:0.5px}
    .metric{display:flex; align-items:baseline; gap:8px}
    .metric .value{font-size:32px; font-weight:800; color:var(--ryanair-blue)}
    .metric .delta{font-size:12px; padding:3px 10px; border-radius:4px; background:#F8F9FA; border:1px solid #DEE2E6; font-weight:600}
    .delta.up{color:var(--good); background:#D4EDDA; border-color:var(--good)}
    .delta.down{color:var(--bad); background:#F8D7DA; border-color:var(--bad)}

    .spark{height:48px; margin-top:10px}
    .sub{font-size:12px; color:var(--ink-dim)}

    .tabs{display:flex; gap:8px; margin:10px 0 20px 0; flex-wrap:wrap}
    .tab{cursor:pointer; padding:10px 18px; border-radius:4px; background:#FFFFFF; border:2px solid #E9ECEF; color:var(--ryanair-blue); font-weight:600; transition:.2s all}
    .tab:hover{border-color:var(--ryanair-yellow)}
    .tab.active{color:#FFFFFF; background:var(--ryanair-blue); border-color:var(--ryanair-blue); box-shadow:0 2px 8px var(--shadow)}

    .section{display:none}
    .section.active{display:block}

    .two-col{display:grid; grid-template-columns:1.2fr .8fr; gap:var(--gap)}
    @media (max-width:1000px){ .two-col{grid-template-columns:1fr} }

    .list{display:grid; gap:12px}
    .row{display:flex; align-items:flex-start; justify-content:space-between; gap:16px; padding:12px 0; border-bottom:1px solid #E9ECEF}
    .row:last-child{border-bottom:none}

    .pill{display:inline-block; font-size:11px; padding:4px 12px; border-radius:4px; border:1px solid #DEE2E6; background:#F8F9FA; color:var(--ryanair-blue); font-weight:600; text-transform:uppercase; letter-spacing:0.3px}
    .pill.good{color:#FFFFFF; background:var(--good); border-color:var(--good)}
    .pill.warn{color:#000; background:var(--warn); border-color:var(--warn)}
    .pill.bad{color:#FFFFFF; background:var(--bad); border-color:var(--bad)}

    table{width:100%; border-collapse:collapse; border-spacing:0}
    th, td{padding:14px 12px; text-align:left; border-bottom:1px solid #E9ECEF}
    th{font-size:11px; color:var(--ryanair-blue); font-weight:700; text-transform:uppercase; letter-spacing:0.5px; background:#F8F9FA}
    td{color:var(--ink)}
    tr:hover{background:#F8F9FA}

    .footer{font-size:12px; margin:20px 0; color:var(--ink-dim)}

    .switch{position:relative; width:48px; height:28px; background:#E9ECEF; border-radius:20px; border:2px solid #DEE2E6; cursor:pointer; transition:.2s all}
    .switch.on{background:var(--ryanair-yellow); border-color:var(--ryanair-yellow)}
    .knob{position:absolute; top:2px; left:2px; width:22px; height:22px; background:#FFFFFF; border-radius:999px; box-shadow:0 2px 6px rgba(0,0,0,.2); transition:left .2s}
    .switch.on .knob{left:22px}

    input[type="range"]{
      width:100%; height:6px; border-radius:3px; background:#E9ECEF; outline:none; -webkit-appearance:none; appearance:none;
    }
    input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; width:20px; height:20px; border-radius:50%; background:var(--ryanair-yellow); cursor:pointer; border:2px solid var(--ryanair-blue);
    }
    input[type="range"]::-moz-range-thumb{
      width:20px; height:20px; border-radius:50%; background:var(--ryanair-yellow); cursor:pointer; border:2px solid var(--ryanair-blue);
    }

    .stat-box{text-align:center; padding:16px; background:#F8F9FA; border-radius:8px; border:2px solid #E9ECEF}
    .stat-label{font-size:11px; color:var(--ink-dim); font-weight:600; text-transform:uppercase; letter-spacing:0.5px; margin-bottom:8px}
    .stat-value{font-size:32px; font-weight:800; color:var(--ryanair-blue); margin:4px 0}
    .stat-delta{font-size:12px; font-weight:600; margin-top:4px}
    .stat-delta.up{color:var(--good)}

    .priority-card{text-align:center; padding:20px; background:#F8F9FA; border-radius:8px; border:2px solid #E9ECEF; transition:.2s all}
    .priority-card:hover{transform:translateY(-4px); box-shadow:0 8px 20px rgba(7,53,144,.15)}
    .priority-icon{width:60px; height:60px; border-radius:50%; margin:0 auto 12px; display:flex; align-items:center; justify-content:center; font-size:28px}
    .priority-title{font-size:13px; font-weight:700; color:var(--ryanair-blue); text-transform:uppercase; letter-spacing:0.5px; margin-bottom:8px}
    .priority-metric{font-size:24px; font-weight:800; color:var(--ryanair-blue); margin-bottom:6px}
    .priority-desc{font-size:12px; color:var(--ink-dim); line-height:1.4}

    .insight-card{background:#FFFFFF; border:2px solid #E9ECEF; border-radius:12px; padding:28px; margin-bottom:20px; display:flex; gap:24px; align-items:flex-start; transition:.3s all}
    .insight-card:hover{box-shadow:0 8px 24px rgba(7,53,144,.12); border-color:#F1C933}
    .insight-number{width:60px; height:60px; border-radius:50%; background:linear-gradient(135deg, #F1C933 0%, #FFD54F 100%); color:#073590; font-size:32px; font-weight:900; display:flex; align-items:center; justify-content:center; flex-shrink:0; box-shadow:0 4px 12px rgba(241,201,51,.3)}
    .insight-content{flex:1}
    .insight-title{margin:0 0 16px 0; font-size:20px; font-weight:700; color:var(--ryanair-blue); line-height:1.3}
    .insight-metrics{display:flex; gap:16px; margin-bottom:16px; flex-wrap:wrap}
    .insight-metric-box{background:#F8F9FA; border:2px solid #E9ECEF; border-radius:8px; padding:12px 16px; min-width:140px; flex:1}
    .insight-metric-box.highlight{background:#FFF9E6; border-color:#F1C933}
    .insight-metric-box.good{background:#D4EDDA; border-color:#28A745}
    .insight-metric-box.bad{background:#F8D7DA; border-color:#DC3545}
    .insight-metric-value{font-size:24px; font-weight:800; color:var(--ryanair-blue); margin-bottom:4px}
    .insight-metric-box.good .insight-metric-value{color:#28A745}
    .insight-metric-box.bad .insight-metric-value{color:#DC3545}
    .insight-metric-label{font-size:11px; color:var(--ink-dim); text-transform:uppercase; letter-spacing:0.5px; font-weight:600}
    .insight-text{margin:0 0 12px 0; color:var(--ink); line-height:1.6; font-size:15px}
    .insight-tag{display:inline-block; padding:6px 14px; border-radius:20px; font-size:12px; font-weight:600; text-transform:uppercase; letter-spacing:0.5px}
    .insight-tag.good{background:#D4EDDA; color:#28A745; border:2px solid #28A745}
    .insight-tag.warn{background:#FFF3CD; color:#856404; border:2px solid #FFC107}
    .insight-tag.bad{background:#F8D7DA; color:#DC3545; border:2px solid #DC3545}

    @media (max-width:900px){
      .insight-card{flex-direction:column}
      .insight-metrics{flex-direction:column}
      .insight-metric-box{min-width:100%}
    }

    /* Print styles */
    @media print{
      header, .tabs, .btn{display:none !important}
      body{background:#fff; color:#111}
      .card{border-color:#ddd; background:#fff; box-shadow:none}
    }
  </style>
</head>
<body>
  <header aria-label="Top navigation">
    <div class="brand" role="img" aria-label="Ryanair Board Dashboard">
      <div class="logo">R</div>
      <div class="title">Ryanair Board BI Dashboard</div>
    </div>
    <div class="controls">
      <button class="btn" id="exportBtn" aria-label="Export to PDF"><span class="dot" aria-hidden="true"></span> Export</button>
      <button class="btn" id="printBtn" aria-label="Print view">Print</button>
      <div class="btn" title="Live data switch" role="switch" aria-checked="true">
        Live
        <div class="switch on" id="liveSwitch"><div class="knob"></div></div>
      </div>
    </div>
  </header>

  <main>
    <div class="tabs" role="tablist" aria-label="Sections">
      <button class="tab active" data-tab="executive" role="tab" aria-selected="true">Executive Overview</button>
      <button class="tab" data-tab="insights" role="tab" aria-selected="false">Board Insights</button>
      <button class="tab" data-tab="overview" role="tab" aria-selected="false">Overview</button>
      <button class="tab" data-tab="kpis" role="tab" aria-selected="false">KPIs</button>
      <button class="tab" data-tab="decisions" role="tab" aria-selected="false">Decisions</button>
      <button class="tab" data-tab="scenarios" role="tab" aria-selected="false">Scenarios</button>
      <button class="tab" data-tab="risks" role="tab" aria-selected="false">Risks</button>
      <button class="tab" data-tab="news" role="tab" aria-selected="false">News</button>
    </div>

    <!-- Executive Overview - Rich Picture Dashboard -->
    <section id="executive" class="section active">
      <div class="grid kpis" id="execKpiGrid"></div>
      
      <div class="two-col" style="margin-top:18px">
        <div class="card">
          <h3>Performance at a Glance</h3>
          <canvas id="performanceRadar" height="280" aria-label="Performance radar chart"></canvas>
          <div class="sub">Six key dimensions: Yield, Load, Ancillary, Cost Control, On-time, Fuel Hedge</div>
        </div>
        <div class="card">
          <h3>Revenue Mix Evolution</h3>
          <canvas id="revenueMix" height="280" aria-label="Revenue composition"></canvas>
          <div class="sub">Quarterly revenue breakdown: Fares vs. Ancillary vs. Other</div>
        </div>
      </div>

      <div class="two-col" style="margin-top:18px">
        <div class="card">
          <h3>Fleet & Network Health</h3>
          <div class="grid" style="grid-template-columns:1fr 1fr; gap:16px; margin-top:12px">
            <div class="stat-box">
              <div class="stat-label">Active Aircraft</div>
              <div class="stat-value" id="fleetCount">578</div>
              <div class="stat-delta up">+12 vs Q3</div>
            </div>
            <div class="stat-box">
              <div class="stat-label">Routes Operated</div>
              <div class="stat-value" id="routeCount">2,400</div>
              <div class="stat-delta up">+35 new</div>
            </div>
            <div class="stat-box">
              <div class="stat-label">Passengers (Q)</div>
              <div class="stat-value" id="paxCount">50.2M</div>
              <div class="stat-delta up">+7.3%</div>
            </div>
            <div class="stat-box">
              <div class="stat-label">Avg Sector Length</div>
              <div class="stat-value" id="sectorLength">1,245km</div>
              <div class="stat-delta">+18km</div>
            </div>
          </div>
          <canvas id="networkMap" height="160" style="margin-top:16px" aria-label="Network visualization"></canvas>
        </div>
        
        <div class="card">
          <h3>Profit Bridge (‚Ç¨M)</h3>
          <canvas id="profitBridge" height="300" aria-label="Profit waterfall"></canvas>
          <div class="sub">Waterfall from prior quarter to current EBIT forecast</div>
        </div>
      </div>

      <div class="card" style="margin-top:18px">
        <h3>Key Strategic Priorities</h3>
        <div class="grid" style="grid-template-columns:repeat(4, 1fr); gap:16px; margin-top:12px">
          <div class="priority-card">
            <div class="priority-icon" style="background:#28A745">üí∞</div>
            <div class="priority-title">Yield Growth</div>
            <div class="priority-metric">+3.2%</div>
            <div class="priority-desc">Selective pricing on primary routes</div>
          </div>
          <div class="priority-card">
            <div class="priority-icon" style="background:#F1C933">üõçÔ∏è</div>
            <div class="priority-title">Ancillary Push</div>
            <div class="priority-metric">‚Ç¨23.0 ARPU</div>
            <div class="priority-desc">Bundles & digital offers expansion</div>
          </div>
          <div class="priority-card">
            <div class="priority-icon" style="background:#073590">‚õΩ</div>
            <div class="priority-title">Fuel Discipline</div>
            <div class="priority-metric">72% hedged</div>
            <div class="priority-desc">Corridor governance & coverage</div>
          </div>
          <div class="priority-card">
            <div class="priority-icon" style="background:#DC3545">‚úÇÔ∏è</div>
            <div class="priority-title">Network Optimize</div>
            <div class="priority-metric">Bottom 10%</div>
            <div class="priority-desc">Cut & redeploy to winners</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Board Insights - Q3 2025 Key Takeaways -->
    <section id="insights" class="section">
      <div class="card" style="background:linear-gradient(135deg, #073590 0%, #1E5AA8 100%); color:#FFF; padding:24px; margin-bottom:24px">
        <h2 style="margin:0 0 8px 0; font-size:28px; font-weight:800">Q3 2025 Board Insights</h2>
        <p style="margin:0; font-size:16px; opacity:0.95">Five profit-focused, decision-relevant insights from Q1 FY2026 performance</p>
      </div>

      <div class="insight-card">
        <div class="insight-number">1</div>
        <div class="insight-content">
          <h3 class="insight-title">Profit Rebound and Yield Strength</h3>
          <div class="insight-metrics">
            <div class="insight-metric-box">
              <div class="insight-metric-value">‚Ç¨820M</div>
              <div class="insight-metric-label">Q1 FY2026 Profit</div>
            </div>
            <div class="insight-metric-box">
              <div class="insight-metric-value">+128%</div>
              <div class="insight-metric-label">vs Prior Year</div>
            </div>
            <div class="insight-metric-box">
              <div class="insight-metric-value">+21%</div>
              <div class="insight-metric-label">Average Fare Increase</div>
            </div>
          </div>
          <p class="insight-text">Ryanair delivered <strong>‚Ç¨820M profit in Q1 FY2026</strong>, more than double the prior year (+128%), driven by a <strong>21% increase in average fares</strong> and strong ancillary sales. This reverses last year's fare softness and puts the airline back on a clear growth path.</p>
          <div class="insight-tag good">‚úì Growth Path Restored</div>
        </div>
      </div>

      <div class="insight-card">
        <div class="insight-number">2</div>
        <div class="insight-content">
          <h3 class="insight-title">Cost Leadership Secured by Fuel Hedging</h3>
          <div class="insight-metrics">
            <div class="insight-metric-box">
              <div class="insight-metric-value">+5%</div>
              <div class="insight-metric-label">Operating Cost Growth</div>
            </div>
            <div class="insight-metric-box">
              <div class="insight-metric-value">~1%</div>
              <div class="insight-metric-label">Unit Cost Ex-Fuel Rise</div>
            </div>
            <div class="insight-metric-box">
              <div class="insight-metric-value">85%</div>
              <div class="insight-metric-label">FY2026 Hedged @ $76/bbl</div>
            </div>
          </div>
          <p class="insight-text">Operating costs rose just <strong>+5%</strong> despite traffic growth, with <strong>unit costs ex-fuel up only ~1%</strong>. Crucially, <strong>85% of FY2026 fuel needs are hedged at ~$76/bbl</strong>, far below spot prices, insulating Ryanair from volatility and giving it a <strong>cost edge over competitors</strong> like easyJet and Wizz.</p>
          <div class="insight-tag good">‚úì Competitive Advantage</div>
        </div>
      </div>

      <div class="insight-card">
        <div class="insight-number">3</div>
        <div class="insight-content">
          <h3 class="insight-title">Core Markets Drive Half of Revenue</h3>
          <div class="insight-metrics">
            <div class="insight-metric-box">
              <div class="insight-metric-value">>50%</div>
              <div class="insight-metric-label">Italy, Spain, UK Revenue</div>
            </div>
            <div class="insight-metric-box">
              <div class="insight-metric-value">‚Ç¨2.48B</div>
              <div class="insight-metric-label">Italy Revenue YTD</div>
            </div>
            <div class="insight-metric-box">
              <div class="insight-metric-value">120</div>
              <div class="insight-metric-label">Routes from Milan (31 based)</div>
            </div>
          </div>
          <p class="insight-text">Italy, Spain, and the UK generate <strong>over 50% of total revenue</strong> (Italy alone ‚Ç¨2.48B YTD). <strong>Italy is a standout:</strong> Ryanair is now the largest airline there, with <strong>31 aircraft based in Milan and 120 routes</strong>. Policy support (e.g. reduced regional taxes) is enabling high-margin growth, but any reversal would be a risk.</p>
          <div class="insight-tag warn">‚ö† Policy Dependency Risk</div>
        </div>
      </div>

      <div class="insight-card">
        <div class="insight-number">4</div>
        <div class="insight-content">
          <h3 class="insight-title">Targeted Network Optimization</h3>
          <div class="insight-metrics">
            <div class="insight-metric-box highlight">
              <div class="insight-metric-value">Picky</div>
              <div class="insight-metric-label">Capacity Allocation</div>
            </div>
            <div class="insight-metric-box bad">
              <div class="insight-metric-value">Spain ‚Üì</div>
              <div class="insight-metric-label">Trimming (AENA charges)</div>
            </div>
            <div class="insight-metric-box good">
              <div class="insight-metric-value">IT/PL/EE ‚Üë</div>
              <div class="insight-metric-label">Expanding High-Margin</div>
            </div>
          </div>
          <p class="insight-text">With Boeing delivery delays limiting fleet growth, Ryanair is being <strong>"picky"</strong> with capacity allocation: trimming unprofitable Spain routes (due to AENA charges), closing Denmark bases (new taxes), while aggressively expanding in <strong>Italy, Poland, and Eastern Europe</strong> where governments incentivize traffic. This strategy is improving yield quality and ensuring aircraft are deployed where margins are highest.</p>
          <div class="insight-tag good">‚úì Margin Quality Focus</div>
        </div>
      </div>

      <div class="insight-card">
        <div class="insight-number">5</div>
        <div class="insight-content">
          <h3 class="insight-title">Competitor Weakness = Opportunity</h3>
          <div class="insight-metrics">
            <div class="insight-metric-box bad">
              <div class="insight-metric-value">-42%</div>
              <div class="insight-metric-label">Wizz Air Profit (20% fleet grounded)</div>
            </div>
            <div class="insight-metric-box bad">
              <div class="insight-metric-value">‚Ç¨25M</div>
              <div class="insight-metric-label">easyJet ATC Strike Hit</div>
            </div>
            <div class="insight-metric-box good">
              <div class="insight-metric-value">Strong</div>
              <div class="insight-metric-label">Ryanair Load Factor Resilience</div>
            </div>
          </div>
          <p class="insight-text"><strong>Wizz Air:</strong> Grounded 20% of fleet from engine issues, profit down 42%. This weakens them in Central/Eastern Europe where Ryanair is moving in. <strong>easyJet:</strong> Facing higher fuel costs and ATC strike disruption (‚Ç¨25M hit in July), plus later booking trends that reduce pricing certainty. Ryanair's <strong>cost leadership, fuel hedge, and load factor resilience</strong> give it the ability to consolidate share while rivals struggle.</p>
          <div class="insight-tag good">‚úì Market Share Opportunity</div>
        </div>
      </div>

      <div class="card" style="background:#FFF9E6; border:2px solid #F1C933; margin-top:24px; padding:20px">
        <h3 style="color:#073590; margin:0 0 12px 0; font-size:18px">‚öñÔ∏è Board Takeaway</h3>
        <p style="margin:0; color:#073590; line-height:1.6; font-size:15px">
          Ryanair enters Q3 2025 in a position of <strong>unusual strength</strong>: record profitability, unmatched cost leadership, and competitor weakness. The most critical levers are:
        </p>
        <ul style="margin:12px 0 0 0; padding-left:24px; color:#073590">
          <li><strong>(a)</strong> Protecting the cost edge via fuel hedging and fleet efficiency</li>
          <li><strong>(b)</strong> Prioritising growth in Italy, Poland, and Eastern Europe</li>
          <li><strong>(c)</strong> Ruthless pruning of low-yield markets like Spain and Denmark</li>
        </ul>
      </div>
    </section>

    <!-- Overview -->
    <section id="overview" class="section">
      <div class="grid kpis" id="kpiGrid"></div>
      <div class="two-col" style="margin-top:18px">
        <div class="card">
          <h3>Executive Summary</h3>
          <div id="execSummary" class="sub"></div>
        </div>
        <div class="card">
          <h3>Profit Focus, next quarter</h3>
          <ul id="profitFocus" class="list" style="margin:0; padding-left:18px"></ul>
        </div>
      </div>
    </section>

    <!-- KPIs detailed -->
    <section id="kpis" class="section">
      <div class="card">
        <h3>Yield and Ancillary Trends</h3>
        <canvas id="trendChart" height="200" class="spark" aria-label="Trend chart"></canvas>
        <div class="sub">Average fare and ancillary ARPU by quarter. Hover to inspect values.</div>
      </div>
      <div class="two-col" style="margin-top:18px">
        <div class="card">
          <h3>Network Profitability Quartiles</h3>
          <table id="networkTable" aria-label="Route profitability">
            <thead><tr><th>Route cohort</th><th>Cash margin</th><th>Action</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="card">
          <h3>Fuel Hedge Ladder</h3>
          <canvas id="hedgeChart" height="200" class="spark" aria-label="Hedge ladder"></canvas>
          <div class="sub">Coverage and price bands by month, next 6 months.</div>
        </div>
      </div>
    </section>

    <!-- Decisions -->
    <section id="decisions" class="section">
      <div class="card">
        <h3>Board Decisions, approval matrix</h3>
        <table id="decisionsTable" aria-label="Decisions">
          <thead><tr><th>Decision</th><th>Owner</th><th>Why now</th><th>P&L impact</th><th>Status</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- Scenarios -->
    <section id="scenarios" class="section">
      <div class="two-col">
        <div class="card">
          <h3>Scenario Controls</h3>
          <div class="row"><div>Yield change</div><input type="range" id="yieldRange" min="-10" max="5" step="1" value="0"/> <div id="yieldVal" class="pill">0%</div></div>
          <div class="row"><div>Fuel change (unhedged)</div><input type="range" id="fuelRange" min="0" max="20" step="1" value="0"/> <div id="fuelVal" class="pill">+$0</div></div>
          <div class="row"><div>Ancillary ARPU change</div><input type="range" id="ancRange" min="0" max="5" step="1" value="0"/> <div id="ancVal" class="pill">+‚Ç¨0</div></div>
          <div class="row"><div>Capacity redeploy</div><input type="range" id="capRange" min="0" max="5" step="1" value="0"/> <div id="capVal" class="pill">+0%</div></div>
          <div class="sub">Adjust sliders to model EBIT deltas. Assumptions are editable in code block <code>ASSUMPTIONS</code>.</div>
        </div>
        <div class="card">
          <h3>EBIT Delta, model output</h3>
          <div id="ebitDelta" style="font-size:36px; font-weight:800; margin:4px 0 12px 0">‚Ç¨0</div>
          <div id="mitigations" class="list"></div>
        </div>
      </div>
    </section>

    <!-- Risks -->
    <section id="risks" class="section">
      <div class="card">
        <h3>Risk Radar</h3>
        <table id="riskTable" aria-label="Risk heatmap">
          <thead><tr><th>Risk</th><th>Market</th><th>Severity</th><th>Probability</th><th>Mitigation</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- News -->
    <section id="news" class="section">
      <div class="card">
        <h3>Negative sentiment tracker</h3>
        <table id="newsTable" aria-label="Recent news">
          <thead><tr><th>Title</th><th>Source</th><th>Date</th><th>Notes</th></tr></thead>
          <tbody></tbody>
        </table>
        <div class="sub" style="margin-top:8px">Keep this fresh after each meeting. Links open in new tab.</div>
      </div>
    </section>

    <div class="footer">This dashboard is a working tool for the Board and the Exec team. Use print button for a clean PDF.
    </div>
  </main>

  <script>
    // ---------------------- DATA: edit here for live values ----------------------
    const DATA = {
      kpis:[
        {label:"Average fare", value:"‚Ç¨48.20", delta:+3.2, trend:[41,43,44,45,46,48,48.2]},
        {label:"Ancillary ARPU", value:"‚Ç¨23.0", delta:+1.0, trend:[19,20,21,21.5,22,22.4,23]},
        {label:"Load factor", value:"95%", delta:+0.4, trend:[92,93,93,94,94,95,95]},
        {label:"Fuel hedge cover", value:"72%", delta:+5, trend:[55,58,60,63,67,70,72]},
        {label:"Ex-fuel cost/pax", value:"‚Ç¨19.6", delta:-0.6, trend:[21.8,21.2,20.6,20.2,19.9,19.8,19.6]},
        {label:"On-time performance", value:"87%", delta:+2, trend:[81,83,82,84,85,86,87]},
      ],
      summary: "Profit is driven by selective yield, ancillary expansion, disciplined fuel hedging and network redeploy to high margin routes.",
      focus:[
        "Selective +2 to +4 percent fare lift on inelastic corridors.",
        "+‚Ç¨1 to +‚Ç¨2 ancillary ARPU through bundles and in-app offers.",
        "Tight hedge corridor and governance. Display P&L per $5 bbl move.",
        "Cut and redeploy capacity from Q4 losers to Q1 winners.",
        "Automation in crew and maintenance to protect margin during disruptions."
      ],
      network:[
        {cohort:"Top Quartile", margin:"‚Ç¨14 - ‚Ç¨18 / pax", action:"Protect, consider +freq", class:"good"},
        {cohort:"Q2", margin:"‚Ç¨8 - ‚Ç¨13 / pax", action:"Test +price, bundle ancillaries", class:"good"},
        {cohort:"Q3", margin:"‚Ç¨3 - ‚Ç¨7 / pax", action:"Hold, prune weak rotations", class:"warn"},
        {cohort:"Bottom Quartile", margin:"< ‚Ç¨3 / pax", action:"Cut or re-base immediately", class:"bad"},
      ],
      hedge:[58,60,63,67,70,72],
      decisions:[
        {name:"Selective price lift (+2 to +4%)", owner:"CRO", why:"Pricing power on primaries", impact:"High", status:"Pending"},
        {name:"Ancillary bundles and RT offers", owner:"Chief Digital", why:"‚Ç¨1 to ‚Ç¨2 ARPU headroom", impact:"High", status:"In-flight"},
        {name:"Fuel hedge corridor tighten", owner:"CFO", why:"Reduce volatility", impact:"High", status:"For Approval"},
        {name:"Cut-and-redeploy network", owner:"COO", why:"Capacity constrained growth", impact:"High", status:"Rolling"},
        {name:"Ops automation pilots", owner:"COO/CTO", why:"Unit cost discipline", impact:"Medium", status:"Kicking off"}
      ],
      risks:[
        {risk:"ATC strikes and outages", market:"France, Greece, EU overflights", sev:"High", prob:"High", mit:"Disruption reserve, timetable buffers, crew flex"},
        {risk:"Airport caps and charges", market:"Dublin, Germany", sev:"High", prob:"Med", mit:"Re-base options, fee negotiations"},
        {risk:"Regulatory fines and baggage rules", market:"Spain", sev:"Med", prob:"Med", mit:"Appeal, UX clarity, comms"},
        {risk:"Delivery cadence / fleet", market:"EU", sev:"Med", prob:"Med", mit:"Short-term leasing, defer marginal routes"},
        {risk:"Fare softness on leisure", market:"Med/SE Europe", sev:"Med", prob:"Med", mit:"Guardrails, targeted promos off-peak"}
      ],
      news:[
        {title:"Up to 600 flights a day cancelled during French strike", src:"The Guardian", date:"02 Oct 2025", url:"https://www.theguardian.com/business/2025/oct/02/up-to-600-flights-a-day-to-be-cancelled-during-french-strike-ryanair-says"},
        {title:"Spain fines budget airlines including Ryanair", src:"The Guardian", date:"22 Nov 2024", url:"https://www.theguardian.com/business/2024/nov/22/spain-fines-budget-airlines-ryanair-179m-appeal"},
        {title:"Night-flight cap at Dublin challenged", src:"RT√â", date:"09 Sep 2025", url:"https://www.rte.ie/news/courts/2025/0909/1532601-ryanair-dublin-flights/"}
      ]
    };

    // Assumptions for scenario model
    const ASSUMPTIONS = {
      pax: 50_000_000, // quarter passengers
      baseFare: 48.2,  // ‚Ç¨
      baseAnc: 23.0,   // ‚Ç¨
      unhedgedFuelPct: 0.28, // proportion of fuel exposure
      fuelCostPerPax: 16.0,  // ‚Ç¨ rough blended
      capRedeployLiftPerPct: 0.15, // EBIT ‚Ç¨ per pax for each 1% redeploy
      marginRate: 0.12 // EBIT as share of revenue for incremental moves
    };

    // ---------------------- RENDER HELPERS ----------------------
    const $$ = s => document.querySelector(s);
    const $$$ = s => document.querySelectorAll(s);

    function renderKPIs(){
      const wrap = $$('#kpiGrid');
      wrap.innerHTML = '';
      DATA.kpis.forEach(k =>{
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <h3>${k.label}</h3>
          <div class="metric">
            <div class="value">${k.value}</div>
            <div class="delta ${k.delta>=0?'up':'down'}">${k.delta>0?'+':''}${k.delta}%</div>
          </div>
          <canvas class="spark" aria-hidden="true"></canvas>
          <div class="sub">7-period trend</div>
        `;
        wrap.appendChild(card);
        drawSpark(card.querySelector('canvas'), k.trend, k.delta>=0? 'up':'down');
      });
    }

    function drawSpark(canvas, data, dir){
      const ctx = canvas.getContext('2d');
      const w = canvas.width = canvas.clientWidth * devicePixelRatio;
      const h = canvas.height = canvas.clientHeight * devicePixelRatio;
      const pad = 10 * devicePixelRatio;
      const min = Math.min(...data), max = Math.max(...data);
      const xs = data.map((_,i)=> pad + i*( (w-2*pad)/(data.length-1)) );
      const ys = data.map(v=> h - pad - ( (v-min)/(max-min||1) )*(h-2*pad));
      ctx.clearRect(0,0,w,h);
      // grid
      ctx.globalAlpha = .2; ctx.strokeStyle = '#DEE2E6';
      [0.25,0.5,0.75].forEach(r=>{ctx.beginPath(); ctx.moveTo(pad, h - pad - r*(h-2*pad)); ctx.lineTo(w-pad, h - pad - r*(h-2*pad)); ctx.stroke();});
      // line
      ctx.globalAlpha = 1; ctx.lineWidth = 3*devicePixelRatio; ctx.strokeStyle = dir==='up'? '#28A745':'#DC3545';
      ctx.beginPath(); ctx.moveTo(xs[0], ys[0]);
      for(let i=1;i<xs.length;i++){ ctx.lineTo(xs[i], ys[i]); }
      ctx.stroke();
      // fill
      const grad = ctx.createLinearGradient(0,0,0,h);
      grad.addColorStop(0, (dir==='up')? 'rgba(40,167,69,.25)':'rgba(220,53,69,.25)');
      grad.addColorStop(1, 'rgba(255,255,255,0)');
      ctx.fillStyle = grad; ctx.beginPath();
      ctx.moveTo(xs[0], h-pad); for(let i=0;i<xs.length;i++){ ctx.lineTo(xs[i], ys[i]); }
      ctx.lineTo(xs.at(-1), h-pad); ctx.closePath(); ctx.fill();
    }

    function renderOverview(){
      $$('#execSummary').textContent = DATA.summary;
      const ul = $$('#profitFocus'); ul.innerHTML = '';
      DATA.focus.forEach(x=>{ const li = document.createElement('li'); li.textContent = x; ul.appendChild(li); });
    }

    function renderNetwork(){
      const tb = $$('#networkTable tbody'); tb.innerHTML = '';
      DATA.network.forEach(n=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${n.cohort}</td><td>${n.margin}</td><td><span class="pill ${n.class}">${n.action}</span></td>`;
        tb.appendChild(tr);
      });
    }

    function renderHedge(){
      const ctx = $$('#hedgeChart').getContext('2d');
      const canvas = $$('#hedgeChart');
      const w = canvas.width = canvas.clientWidth * devicePixelRatio;
      const h = canvas.height = canvas.clientHeight * devicePixelRatio;
      ctx.clearRect(0,0,w,h);
      const pad = 14*devicePixelRatio; const bars = DATA.hedge; const max = 100;
      const bw = (w - pad*2)/bars.length * 0.7; // bar width
      bars.forEach((v,i)=>{
        const x = pad + i*((w-2*pad)/bars.length) + 6*devicePixelRatio;
        const barH = (v/max) * (h-2*pad);
        ctx.fillStyle = '#F1C933';
        ctx.fillRect(x, h-pad-barH, bw, barH);
        ctx.fillStyle = '#073590'; ctx.font = `${12*devicePixelRatio}px ${getComputedStyle(document.body).fontFamily}`;
        ctx.globalAlpha = 1; ctx.fillText(`${v}%`, x, h-pad-barH-6*devicePixelRatio);
        ctx.globalAlpha = 1;
      });
      // axis line
      ctx.strokeStyle = '#DEE2E6'; ctx.beginPath(); ctx.moveTo(pad, h-pad); ctx.lineTo(w-pad, h-pad); ctx.stroke();
    }

    function renderDecisions(){
      const tb = $$('#decisionsTable tbody'); tb.innerHTML = '';
      DATA.decisions.forEach(d=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${d.name}</td><td>${d.owner}</td><td>${d.why}</td><td><span class="pill">${d.impact}</span></td><td><span class="pill ${d.status==='For Approval'?'warn': d.status==='Pending'?'bad':'good'}">${d.status}</span></td>`;
        tb.appendChild(tr);
      });
    }

    function renderRisks(){
      const tb = $$('#riskTable tbody'); tb.innerHTML = '';
      DATA.risks.forEach(r=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${r.risk}</td><td>${r.market}</td><td><span class="pill ${r.sev==='High'?'bad': r.sev==='Med'?'warn':'good'}">${r.sev}</span></td><td>${r.prob}</td><td>${r.mit}</td>`;
        tb.appendChild(tr);
      });
    }

    function renderNews(){
      const tb = $$('#newsTable tbody'); tb.innerHTML = '';
      DATA.news.forEach(n=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td><a href="${n.url}" target="_blank" rel="noopener">${n.title}</a></td><td>${n.src}</td><td>${n.date}</td><td class="sub">Monitor sentiment, prepare comms</td>`;
        tb.appendChild(tr);
      });
    }

    // ---------------------- SCENARIO MODEL ----------------------
    function fmtEUR(x){
      return '‚Ç¨' + x.toLocaleString(undefined,{maximumFractionDigits:0});
    }
    function updateScenario(){
      const y = Number($$('#yieldRange').value); // percent change
      const f = Number($$('#fuelRange').value);  // $ per bbl increase
      const a = Number($$('#ancRange').value);   // ‚Ç¨ per pax increase
      const c = Number($$('#capRange').value);   // percent redeploy
      $$('#yieldVal').textContent = `${y}%`;
      $$('#fuelVal').textContent = `+$${f}`;
      $$('#ancVal').textContent = `+‚Ç¨${a}`;
      $$('#capVal').textContent = `+${c}%`;

      const revFare = ASSUMPTIONS.pax * ASSUMPTIONS.baseFare * (y/100);
      const revAnc  = ASSUMPTIONS.pax * a;
      const fuelHit = ASSUMPTIONS.pax * ASSUMPTIONS.fuelCostPerPax * ASSUMPTIONS.unhedgedFuelPct * (f/100); // rough approximation
      const capLift = ASSUMPTIONS.pax * (c/100) * ASSUMPTIONS.capRedeployLiftPerPct;

      // EBIT delta: margin on revenue changes minus cost headwinds
      const ebit = (revFare + revAnc) * ASSUMPTIONS.marginRate + capLift - fuelHit;
      $$('#ebitDelta').textContent = fmtEUR(ebit);

      const mit = $$('#mitigations'); mit.innerHTML = '';
      const bullets = [
        y<0? 'Tighten promos to off-peak only' : 'Apply guardrails to protect load factor',
        a>0? 'Push bundles and in-app offers' : 'Enable cross-sell tests to find +‚Ç¨1 headroom',
        f>0? 'Top-up hedges within corridor and add schedule buffers' : 'Maintain corridor discipline',
        c>0? 'Redeploy aircraft to Q1 winners and cut bottom quartile routes' : 'Keep redeploy shortlist warm'
      ];
      bullets.forEach(b=>{ const div = document.createElement('div'); div.className='row'; div.textContent=b; mit.appendChild(div); });
    }

    // ---------------------- EVENTS ----------------------
    $$$('.tab').forEach(t=> t.addEventListener('click', e=>{
      $$$('.tab').forEach(x=>{x.classList.remove('active'); x.setAttribute('aria-selected','false')});
      t.classList.add('active'); t.setAttribute('aria-selected','true');
      $$$('.section').forEach(s=> s.classList.remove('active'));
      $$('#'+t.dataset.tab).classList.add('active');
    }));

    $$('#printBtn').addEventListener('click', ()=> window.print());
    $$('#exportBtn').addEventListener('click', ()=> window.print());
    $$('#liveSwitch').addEventListener('click', (e)=> e.currentTarget.classList.toggle('on'));

    ['yieldRange','fuelRange','ancRange','capRange'].forEach(id=>{
      $$('#'+id).addEventListener('input', updateScenario);
    });

    // ---------------------- EXECUTIVE OVERVIEW CHARTS ----------------------
    function renderExecKPIs(){
      const wrap = $$('#execKpiGrid');
      wrap.innerHTML = '';
      const highlights = [
        {label:"Revenue/Pax", value:"‚Ç¨71.20", delta:+4.1, trend:[62,65,67,68,69,70,71.2]},
        {label:"EBIT Margin", value:"18.5%", delta:+1.2, trend:[15,15.5,16,16.8,17.5,18,18.5]},
        {label:"Load Factor", value:"95%", delta:+0.4, trend:[92,93,93,94,94,95,95]},
        {label:"Unit Cost", value:"‚Ç¨32.8", delta:-1.8, trend:[36,35.5,35,34.2,33.5,33,32.8]},
        {label:"Punctuality", value:"87%", delta:+2, trend:[81,83,82,84,85,86,87]},
        {label:"Fleet Util.", value:"12.1h", delta:+0.3, trend:[11.2,11.4,11.6,11.8,11.9,12,12.1]},
      ];
      highlights.forEach(k =>{
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <h3>${k.label}</h3>
          <div class="metric">
            <div class="value">${k.value}</div>
            <div class="delta ${k.delta>=0?'up':'down'}">${k.delta>0?'+':''}${k.delta}%</div>
          </div>
          <canvas class="spark" aria-hidden="true"></canvas>
        `;
        wrap.appendChild(card);
        drawSpark(card.querySelector('canvas'), k.trend, k.delta>=0? 'up':'down');
      });
    }

    function renderPerformanceRadar(){
      const canvas = $$('#performanceRadar');
      const ctx = canvas.getContext('2d');
      const w = canvas.width = canvas.clientWidth * devicePixelRatio;
      const h = canvas.height = canvas.clientHeight * devicePixelRatio;
      ctx.clearRect(0,0,w,h);
      
      const centerX = w/2, centerY = h/2;
      const radius = Math.min(w,h)/2 - 40*devicePixelRatio;
      const metrics = [
        {label:'Yield', value:0.85},
        {label:'Load', value:0.95},
        {label:'Ancillary', value:0.78},
        {label:'Cost', value:0.88},
        {label:'On-time', value:0.87},
        {label:'Hedge', value:0.72}
      ];
      
      // Grid circles
      ctx.strokeStyle = '#E9ECEF'; ctx.lineWidth = 1*devicePixelRatio;
      [0.2,0.4,0.6,0.8,1].forEach(r=>{
        ctx.beginPath();
        ctx.arc(centerX, centerY, radius*r, 0, Math.PI*2);
        ctx.stroke();
      });
      
      // Axes
      ctx.strokeStyle = '#DEE2E6';
      metrics.forEach((_,i)=>{
        const angle = (i/metrics.length) * Math.PI * 2 - Math.PI/2;
        ctx.beginPath();
        ctx.moveTo(centerX, centerY);
        ctx.lineTo(centerX + Math.cos(angle)*radius, centerY + Math.sin(angle)*radius);
        ctx.stroke();
      });
      
      // Data polygon
      ctx.beginPath();
      ctx.fillStyle = 'rgba(241,201,51,0.3)';
      ctx.strokeStyle = '#F1C933';
      ctx.lineWidth = 3*devicePixelRatio;
      metrics.forEach((m,i)=>{
        const angle = (i/metrics.length) * Math.PI * 2 - Math.PI/2;
        const r = radius * m.value;
        const x = centerX + Math.cos(angle)*r;
        const y = centerY + Math.sin(angle)*r;
        if(i===0) ctx.moveTo(x,y);
        else ctx.lineTo(x,y);
      });
      ctx.closePath();
      ctx.fill();
      ctx.stroke();
      
      // Labels
      ctx.fillStyle = '#073590';
      ctx.font = `${12*devicePixelRatio}px ${getComputedStyle(document.body).fontFamily}`;
      ctx.textAlign = 'center';
      metrics.forEach((m,i)=>{
        const angle = (i/metrics.length) * Math.PI * 2 - Math.PI/2;
        const labelR = radius + 20*devicePixelRatio;
        const x = centerX + Math.cos(angle)*labelR;
        const y = centerY + Math.sin(angle)*labelR;
        ctx.fillText(m.label, x, y);
      });
    }

    function renderRevenueMix(){
      const canvas = $$('#revenueMix');
      const ctx = canvas.getContext('2d');
      const w = canvas.width = canvas.clientWidth * devicePixelRatio;
      const h = canvas.height = canvas.clientHeight * devicePixelRatio;
      ctx.clearRect(0,0,w,h);
      
      const quarters = ['Q1', 'Q2', 'Q3', 'Q4'];
      const fares = [2100, 2250, 2400, 2520];
      const ancillary = [950, 1050, 1150, 1200];
      const other = [120, 130, 140, 150];
      
      const pad = 40*devicePixelRatio;
      const barWidth = (w - pad*2) / quarters.length * 0.6;
      const maxVal = 4000;
      
      quarters.forEach((q,i)=>{
        const x = pad + i*((w-pad*2)/quarters.length) + 20*devicePixelRatio;
        const total = fares[i] + ancillary[i] + other[i];
        
        const fareH = (fares[i]/maxVal) * (h-pad*2);
        const ancH = (ancillary[i]/maxVal) * (h-pad*2);
        const otherH = (other[i]/maxVal) * (h-pad*2);
        
        // Fares (blue)
        ctx.fillStyle = '#073590';
        ctx.fillRect(x, h-pad-fareH, barWidth, fareH);
        
        // Ancillary (yellow)
        ctx.fillStyle = '#F1C933';
        ctx.fillRect(x, h-pad-fareH-ancH, barWidth, ancH);
        
        // Other (gray)
        ctx.fillStyle = '#6C757D';
        ctx.fillRect(x, h-pad-fareH-ancH-otherH, barWidth, otherH);
        
        // Quarter label
        ctx.fillStyle = '#073590';
        ctx.font = `${12*devicePixelRatio}px ${getComputedStyle(document.body).fontFamily}`;
        ctx.textAlign = 'center';
        ctx.fillText(q, x + barWidth/2, h-pad+20*devicePixelRatio);
      });
      
      // Legend
      const legendY = 20*devicePixelRatio;
      ctx.fillStyle = '#073590'; ctx.fillRect(w-180*devicePixelRatio, legendY, 15*devicePixelRatio, 15*devicePixelRatio);
      ctx.fillStyle = '#073590'; ctx.fillText('Fares', w-150*devicePixelRatio, legendY+12*devicePixelRatio);
      ctx.fillStyle = '#F1C933'; ctx.fillRect(w-100*devicePixelRatio, legendY, 15*devicePixelRatio, 15*devicePixelRatio);
      ctx.fillStyle = '#073590'; ctx.fillText('Ancillary', w-70*devicePixelRatio, legendY+12*devicePixelRatio);
    }

    function renderNetworkMap(){
      const canvas = $$('#networkMap');
      const ctx = canvas.getContext('2d');
      const w = canvas.width = canvas.clientWidth * devicePixelRatio;
      const h = canvas.height = canvas.clientHeight * devicePixelRatio;
      ctx.clearRect(0,0,w,h);
      
      // Simplified network visualization - dots representing bases/airports
      const bases = [
        {x:0.2, y:0.6, size:20, label:'DUB'},
        {x:0.35, y:0.4, size:18, label:'STN'},
        {x:0.45, y:0.5, size:16, label:'BCN'},
        {x:0.5, y:0.35, size:15, label:'BER'},
        {x:0.6, y:0.55, size:14, label:'FCO'},
        {x:0.7, y:0.45, size:13, label:'WAW'},
        {x:0.4, y:0.7, size:12, label:'MAD'},
        {x:0.55, y:0.65, size:11, label:'ATH'}
      ];
      
      // Connection lines
      ctx.strokeStyle = 'rgba(241,201,51,0.2)';
      ctx.lineWidth = 1*devicePixelRatio;
      for(let i=0; i<bases.length; i++){
        for(let j=i+1; j<bases.length; j++){
          if(Math.random()>0.6){
            ctx.beginPath();
            ctx.moveTo(bases[i].x*w, bases[i].y*h);
            ctx.lineTo(bases[j].x*w, bases[j].y*h);
            ctx.stroke();
          }
        }
      }
      
      // Base dots
      bases.forEach(b=>{
        ctx.fillStyle = '#073590';
        ctx.beginPath();
        ctx.arc(b.x*w, b.y*h, b.size*devicePixelRatio/2, 0, Math.PI*2);
        ctx.fill();
        
        ctx.fillStyle = '#F1C933';
        ctx.font = `${10*devicePixelRatio}px ${getComputedStyle(document.body).fontFamily}`;
        ctx.textAlign = 'center';
        ctx.fillText(b.label, b.x*w, b.y*h - b.size*devicePixelRatio/2 - 5*devicePixelRatio);
      });
    }

    function renderProfitBridge(){
      const canvas = $$('#profitBridge');
      const ctx = canvas.getContext('2d');
      const w = canvas.width = canvas.clientWidth * devicePixelRatio;
      const h = canvas.height = canvas.clientHeight * devicePixelRatio;
      ctx.clearRect(0,0,w,h);
      
      const items = [
        {label:'Q3 EBIT', value:820, type:'base'},
        {label:'Yield ‚Üë', value:120, type:'positive'},
        {label:'Ancillary ‚Üë', value:85, type:'positive'},
        {label:'Volume ‚Üë', value:65, type:'positive'},
        {label:'Fuel ‚Üì', value:-45, type:'negative'},
        {label:'Costs ‚Üì', value:-35, type:'negative'},
        {label:'Q4 EBIT', value:1010, type:'total'}
      ];
      
      const pad = 30*devicePixelRatio;
      const barW = (w - pad*2) / items.length * 0.7;
      const maxVal = 1200;
      let runningTotal = 0;
      
      items.forEach((item,i)=>{
        const x = pad + i*((w-pad*2)/items.length);
        let barH, barY;
        
        if(item.type === 'base' || item.type === 'total'){
          barH = (item.value/maxVal) * (h-pad*2);
          barY = h - pad - barH;
          ctx.fillStyle = item.type === 'total' ? '#28A745' : '#073590';
          runningTotal = item.value;
        } else {
          const absVal = Math.abs(item.value);
          barH = (absVal/maxVal) * (h-pad*2);
          if(item.type === 'positive'){
            barY = h - pad - (runningTotal/maxVal)*(h-pad*2) - barH;
            ctx.fillStyle = '#F1C933';
            runningTotal += item.value;
          } else {
            barY = h - pad - (runningTotal/maxVal)*(h-pad*2);
            ctx.fillStyle = '#DC3545';
            runningTotal += item.value;
          }
        }
        
        ctx.fillRect(x, barY, barW, barH);
        
        // Label
        ctx.fillStyle = '#073590';
        ctx.font = `${10*devicePixelRatio}px ${getComputedStyle(document.body).fontFamily}`;
        ctx.textAlign = 'center';
        ctx.save();
        ctx.translate(x + barW/2, h-5*devicePixelRatio);
        ctx.rotate(-Math.PI/4);
        ctx.fillText(item.label, 0, 0);
        ctx.restore();
        
        // Value on bar
        ctx.fillStyle = '#FFF';
        ctx.fillText('‚Ç¨'+Math.abs(item.value)+'M', x + barW/2, barY + barH/2);
      });
    }

    // ---------------------- INIT ----------------------
    renderExecKPIs();
    renderPerformanceRadar();
    renderRevenueMix();
    renderNetworkMap();
    renderProfitBridge();
    renderKPIs();
    renderOverview();
    renderNetwork();
    renderHedge();
    renderDecisions();
    renderRisks();
    renderNews();
    updateScenario();
  </script>
</body>
</html>
